{% extends "base.html" %}
{% block content %}
<style>
      #map {
        height: 300px;
      }
      html, body {
        height: 100%; margin: 30px; padding: 10px;
      }
      #restaurant-pic{
        width:300px;
        height:300px;
      }
</style>
  <div>
    {% if "current_user" in session %}
      <button id="fav-restaurant" class="favorite-btn">&hearts; Add to Favorite</button><br>
        <a href="/comments/{{ exist_rest.restaurant_id }}">New Comment</a><br>
        <a href="/ratings/{{ exist_rest.restaurant_id }}">New Rating</a>
    {% endif %}
    </div>
  <div class="row">
    <div class="col-xs-4">
      <img id="restaurant-pic" src={{ rest_info['image_url'] }}>
    </div>
  
    <div class="col-xs-3">
      <b>Restaurant Information</b><br>
      <h2>{{ rest_info['name'] }}</h2>Likes: {{ num_likes }}<br>
      Category: {{ rest_info['categories'][0]['title'] }}<br>
      Phone: {{ rest_info['phone'] }}<br>
      Price Level: {{ rest_info['price'] }}<br>
      Hours: {{ rest_info['hours'][0]['open'][0]['start']}} - {{ rest_info['hours'][0]['open'][0]['end']}}<br>
      Location: {{ rest_info['location']['address1'] }}<br>
                {{ rest_info['location']['city'] }}, {{ rest_info['location']['state'] }} 
                {{ rest_info['location']['zip_code'] }}
      {% if "current_user" in session %}
      <form action="/like_rest" method="POST">
        <input type="submit" value="Like!">
      </form>
      {% endif %}
    </div>
      <div id="map" class="col-xs-5"></div>
      <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyATx-dTNuzvPtdyA7R0YmOYH5gD498D4Vs&callback=initMap"
      async defer></script>
      <script>
      var userLatlng = {lat: {{ rest_info['coordinates']['latitude'] }},
                        lng: {{ rest_info['coordinates']['longitude'] }}};
      var map;
      function initMap() {
        map = new google.maps.Map(document.getElementById('map'), {
          center: {lat: userLatlng.lat, lng: userLatlng.lng},
          zoom: 12
          // zoomControl: true,
        });
        var marker = new google.maps.Marker({
          position: userLatlng,
          icon: 'https://cdn3.iconfinder.com/data/icons/google-material-design-icons/48/ic_local_restaurant_48px-32.png',
          map: map
        });

        var contentString = '<div><h2>{{ rest_info['name'] }}</h2></div>' + 
                 '<p>{{ rest_info['location']['address1'] }}</p>' +
                 '<p>{{ rest_info['location']['city'] }}, {{ rest_info['location']['state'] }}</p>';
        var infowindow = new google.maps.InfoWindow({
        content: contentString
        });

        marker.addListener('click', function() {
        infowindow.open(map, marker);
        });
      }
        </script>
  </div>
</div>    

{% endblock %}

